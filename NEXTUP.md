finish perf enhancements
implement input handling
